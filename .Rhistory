library(lmtest)
library(stargazer)
#一定要考慮
#使用vcovHC函數來計算HC1型的異質變異（即橫斷面資料下的線性迴歸模型）
coeftest(ols1, vcov. = vcovHC, type="HC1") -> ols1_coeftest
coeftest(ols2, vcov. = vcovHC, type="HC1") -> ols2_coeftest
library(stargazer)
stargazer(ols1,ols2,type="html")
knitr::opts_chunk$set(echo = TRUE)
library(stargazer)
stargazer(ols1,ols2,type="html")
library(dplyr)
library(magrittr)
library(AER)
data("CigarettesSW")
library(dplyr)
library(magrittr)
library(AER)
data("CigarettesSW")
CigarettesSW %<>% as_tibble
CigarettesSW
library(dplyr)
library(magrittr)
library(AER)
data("CigarettesSW")
CigarettesSW %<>% filter(year=="1995")
CigarettesSW %<>%
mutate(
rprice=price/cpi,
rincome=income/population/cpi,
tdiff=(taxs-tax)/cpi
)
model1<-log(packs) ~ log(rprice)
model2<-log(packs) ~ log(rprice) + log(rincome)
ols1<-lm(model1,CigarettesSW)
ols2<-lm(model2,CigarettesSW)
library(sandwich)
library(lmtest)
library(stargazer)
#一定要考慮
#使用vcovHC函數來計算HC1型的異質變異（即橫斷面資料下的線性迴歸模型）
coeftest(ols1, vcov. = vcovHC, type="HC1") -> ols1_coeftest
coeftest(ols2, vcov. = vcovHC, type="HC1") -> ols2_coeftest
library(stargazer)
stargazer(ols1,ols2,type="html")
knitr::opts_chunk$set(echo = TRUE)
summary(cars)
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(magrittr)
library(AER)
data("CigarettesSW")
library(dplyr)
library(magrittr)
library(AER)
data("CigarettesSW")
CigarettesSW %<>% as_tibble
CigarettesSW
CigarettesSW %<>% filter(year=="1995")
CigarettesSW %<>%
mutate(
rprice=price/cpi,
rincome=income/population/cpi,
tdiff=(taxs-tax)/cpi
)
CigarettesSW %<>%
mutate(
rprice=price/cpi,
rincome=income/population/cpi,
tdiff=(taxs-tax)/cpi
)
model1<-log(packs) ~ log(rprice)
model2<-log(packs) ~ log(rprice) + log(rincome)
ols1<-lm(model1,CigarettesSW)
ols2<-lm(model2,CigarettesSW)
library(sandwich)
library(lmtest)
library(stargazer)
#使用vcovHC函數來計算HC1型的異質變異（即橫斷面資料下的線性迴歸模型）
coeftest(ols1, vcov. = vcovHC, type="HC1") -> ols1_coeftest
coeftest(ols2, vcov. = vcovHC, type="HC1") -> ols2_coeftest
install.packages("stargazer")
knitr::opts_chunk$set(echo = TRUE)
library(stargazer)
stargazer(ols1,ols2,type="html")
library(stargazer)
stargazer(ols1,ols2,type="html")
install.packages(c("dplyr", "magrittr", "AER", "sandwich", "lmtest", "stargazer"))
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(magrittr)
library(AER)
data("CigarettesSW")
library(dplyr)
library(magrittr)
library(AER)
data("CigarettesSW")
CigarettesSW %<>% as_tibble
CigarettesSW
CigarettesSW %<>% as_tibble
CigarettesSW
CigarettesSW %<>% filter(year=="1995")
CigarettesSW %<>% as_tibble
CigarettesSW
CigarettesSW %<>% filter(year=="1995")
CigarettesSW %<>%
mutate(
rprice=price/cpi,
rincome=income/population/cpi,
tdiff=(taxs-tax)/cpi
)
model1<-log(packs) ~ log(rprice)
model2<-log(packs) ~ log(rprice) + log(rincome)
#s的估計採用sandwich（robot standard error)
library(sandwich)
library(lmtest)
library(stargazer)
#s的估計採用sandwich（robot standard error)
library(sandwich)
library(lmtest)
library(stargazer)
#s的估計採用sandwich（robot standard error)
library(sandwich)
library(lmtest)
library(stargazer)
#使用vcovHC函數來計算HC1型的異質變異（即橫斷面資料下的線性迴歸模型）
coeftest(ols1, vcov. = vcovHC, type="HC1") -> ols1_coeftest
model1<-log(packs) ~ log(rprice)
model2<-log(packs) ~ log(rprice) + log(rincome)
ols1<-lm(model1,CigarettesSW)
ols2<-lm(model2,CigarettesSW)
#s的估計採用sandwich（robot standard error)
library(sandwich)
library(lmtest)
library(stargazer)
#使用vcovHC函數來計算HC1型的異質變異（即橫斷面資料下的線性迴歸模型）
coeftest(ols1, vcov. = vcovHC, type="HC1") -> ols1_coeftest
coeftest(ols2, vcov. = vcovHC, type="HC1") -> ols2_coeftest
stargazer(ols1,ols2,type="html")
#s的估計採用sandwich（robot standard error)
library(sandwich)
library(lmtest)
library(stargazer)
#使用vcovHC函數來計算HC1型的異質變異（即橫斷面資料下的線性迴歸模型）
coeftest(ols1, vcov. = vcovHC, type="HC1") -> ols1_coeftest
coeftest(ols2, vcov. = vcovHC, type="HC1") -> ols2_coeftest
stargazer(ols1,ols2,type="html")
stargazer(ols1,type="html")
stargazer(ols1,ols2,type="html")
stargazer(ols1,ols2
)
stargazer(ols1,ols2,type="html")
#s的估計採用sandwich（robot standard error)
library(sandwich)
library(lmtest)
library(stargazer)
#使用vcovHC函數來計算HC1型的異質變異（即橫斷面資料下的線性迴歸模型）
coeftest(ols1, vcov. = vcovHC, type="HC1") -> ols1_coeftest
coeftest(ols2, vcov. = vcovHC, type="HC1") -> ols2_coeftest
stargazer(ols1,ols2,type="html")
tsls_1iv <- ivreg(
log(packs) ~ log(rprice) + log(rincome) | log(rincome) + tdiff,
data=CigarettesSW
)
tsls_2iv <- ivreg(
log(packs) ~ log(rprice) + log(rincome) | log(rincome) + tdiff + I(tax/cpi),
data=CigarettesSW
)
summary(tsls_1iv, vcov = sandwich, diagnostics = TRUE, df=Inf) -> tsls_1iv_tests
summary(tsls_2iv, vcov = sandwich, diagnostics = TRUE, df=Inf) -> tsls_2iv_tests
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(magrittr)
library(AER)
data("CigarettesSW")
CigarettesSW %<>% as_tibble
CigarettesSW
CigarettesSW %<>% filter(year=="1995")
CigarettesSW %<>%
mutate(
rprice=price/cpi,
rincome=income/population/cpi,
tdiff=(taxs-tax)/cpi
)
model1<-log(packs) ~ log(rprice)
model2<-log(packs) ~ log(rprice) + log(rincome)
ols1<-lm(model1,CigarettesSW)
ols2<-lm(model2,CigarettesSW)
#s的估計採用sandwich（robust standard error)
library(sandwich)
library(lmtest)
library(stargazer)
#使用vcovHC函數來計算HC1型的異質變異（即橫斷面資料下的線性迴歸模型）
coeftest(ols1, vcov. = vcovHC, type="HC1") -> ols1_coeftest
coeftest(ols2, vcov. = vcovHC, type="HC1") -> ols2_coeftest
stargazer(ols1,ols2,type="html")
tsls_1iv <- ivreg(
log(packs) ~ log(rprice) + log(rincome) | log(rincome) + tdiff,
data=CigarettesSW
)
tsls_2iv <- ivreg(
log(packs) ~ log(rprice) + log(rincome) | log(rincome) + tdiff + I(tax/cpi),
data=CigarettesSW
)
summary(tsls_1iv, vcov = sandwich, diagnostics = TRUE, df=Inf) -> tsls_1iv_tests
summary(tsls_2iv, vcov = sandwich, diagnostics = TRUE, df=Inf) -> tsls_2iv_tests
#df=inf因為會根據樣本數去查表，如果數大的話會趨近z表，但因為只有48，所以可能查的卡方分配
#vcov = sandwich為了異質變異，得到robust
summary(tsls_1iv, vcov = sandwich, diagnostics = TRUE, df=Inf) -> tsls_1iv_tests
summary(tsls_2iv, vcov = sandwich, diagnostics = TRUE, df=Inf) -> tsls_2iv_tests
#df=inf因為會根據樣本數去查表，如果數大的話會趨近z表，但因為只有48，所以可能查的卡方分配
#vcov = sandwich為了異質變異，得到robust standard error
tsls_1iv <- ivreg(
log(packs) ~ log(rprice) + log(rincome) | log(rincome) + tdiff,
data=CigarettesSW
)
tsls_2iv <- ivreg(
log(packs) ~ log(rprice) + log(rincome) | log(rincome) + tdiff + I(tax/cpi),
data=CigarettesSW
)
sandwich_HC1<-function(x,adjust=TRUE){
sandwich(x,adjust=adjust)
}
summary(tsls_2iv, vcov = sandwich_HC1, diagnostics = TRUE, df=Inf) -> tsls_2iv_tests_hc1
tsls_2iv_tests
tsls_1iv_tests
lm(model2,data=CigarettesSW)
tsls_1iv_tests
tsls_2iv_tests
stargazer(tsls_1iv,tsls_2iv,type="html",
column.labels = c("one IV", "two IVs"),
add.lines = list(c("TSLS tests p-value", "",""),
c("Q1: Sargan","NA","0.5641"),
c("Q2: Weak instruments","1.4e-08","<2e-16"),
c("Q3: Wu-Hausman","0.263","0.0569")
))
stargazer(tsls_1iv,tsls_2iv,type="html",
column.labels = c("one IV", "two IVs"),
add.lines = list(c("TSLS tests p-value", "",""),
c("Q1: Sargan","NA","0.5641"),
c("Q2: Weak instruments","1.4e-08","<2e-16"),
c("Q3: Wu-Hausman","0.263","0.0569")
))
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(magrittr)
library(AER)
data("CigarettesSW")
CigarettesSW %<>% as_tibble
CigarettesSW
CigarettesSW %<>% filter(year=="1995")
CigarettesSW %<>%
mutate(
rprice=price/cpi,
rincome=income/population/cpi,
tdiff=(taxs-tax)/cpi
)
model1<-log(packs) ~ log(rprice)
model2<-log(packs) ~ log(rprice) + log(rincome)
ols1<-lm(model1,CigarettesSW)
ols2<-lm(model2,CigarettesSW)
#s的估計採用sandwich（robust standard error)
library(sandwich)
library(lmtest)
library(stargazer)
#使用vcovHC函數來計算HC1型的異質變異（即橫斷面資料下的線性迴歸模型）
coeftest(ols1, vcov. = vcovHC, type="HC1") -> ols1_coeftest
coeftest(ols2, vcov. = vcovHC, type="HC1") -> ols2_coeftest
stargazer(ols1,ols2,type="html")
tsls_1iv <- ivreg(
log(packs) ~ log(rprice) + log(rincome) | log(rincome) + tdiff,
data=CigarettesSW
)
tsls_2iv <- ivreg(
log(packs) ~ log(rprice) + log(rincome) | log(rincome) + tdiff + I(tax/cpi),
data=CigarettesSW
)
summary(tsls_1iv, vcov = sandwich, diagnostics = TRUE, df=Inf) -> tsls_1iv_tests
summary(tsls_2iv, vcov = sandwich, diagnostics = TRUE, df=Inf) -> tsls_2iv_tests
#df=inf因為會根據樣本數去查表，如果數大的話會趨近z表，但因為只有48，所以可能查的卡方分配
#vcov = sandwich為了異質變異，得到robust standard error
tsls_1iv_tests
lm(model2,data=CigarettesSW)
tsls_2iv_tests
stargazer(tsls_1iv,tsls_2iv,type="html",
column.labels = c("one IV", "two IVs"),
add.lines = list(c("TSLS tests p-value", "",""),
c("Q1: Sargan","NA","0.5641"),
c("Q2: Weak instruments","1.4e-08","<2e-16"),
c("Q3: Wu-Hausman","0.263","0.0569")
))
stargazer(tsls_1iv,tsls_2iv,type="text",
column.labels = c("one IV", "two IVs"),
add.lines = list(c("TSLS tests p-value", "",""),
c("Q1: Sargan","NA","0.5641"),
c("Q2: Weak instruments","1.4e-08","<2e-16"),
c("Q3: Wu-Hausman","0.263","0.0569")
))
stargazer(ols1,ols2,type="text")
knitr::opts_chunk$set(echo = TRUE,warning=F,message=F)
labordata %<>% filter (YEAR=="7")
library(readr)
labordata <- read_csv("http://people.stern.nyu.edu/wgreene/Econometrics/cornwell&rupert.csv")
library(dplyr)
library(magrittr)
labordata
labordata %<>% filter (YEAR=="7")
knitr::opts_chunk$set(echo = TRUE,warning=F,message=F)
library(readr)
labordata <- read_csv("http://people.stern.nyu.edu/wgreene/Econometrics/cornwell&rupert.csv")
library(dplyr)
library(magrittr)
labordata
model1<-WKS~LWAGE
model1<-WKS~LWAGE
ggplot(mpg, aes(WKS, LWAGE))
install.packages("ggplot")
library(readr)
labordata <- read_csv("http://people.stern.nyu.edu/wgreene/Econometrics/cornwell&rupert.csv")
library(dplyr)
library(magrittr)
library(ggplot)
library(readr)
labordata <- read_csv("http://people.stern.nyu.edu/wgreene/Econometrics/cornwell&rupert.csv")
library("ggplot2", lib.loc="/Library/Frameworks/R.framework/Versions/3.4/Resources/library")
library(dplyr)
library(magrittr)
library(ggplot2)
install.packages("ggplot2")
knitr::opts_chunk$set(echo = TRUE,warning=F,message=F)
library(readr)
labordata <- read_csv("http://people.stern.nyu.edu/wgreene/Econometrics/cornwell&rupert.csv")
library(dplyr)
library(magrittr)
library(ggplot2)
model1<-WKS~LWAGE
ggplot(mpg, aes(WKS, LWAGE))
labordata %<>% filter (YEAR=="7")
labordata
labordata %<>% filter (YEAR=="7")
model1<-WKS~LWAGE
ggplot(mpg, aes(WKS, LWAGE))
library(readr)
labordata <- read_csv("http://people.stern.nyu.edu/wgreene/Econometrics/cornwell&rupert.csv")
library(dplyr)
library(magrittr)
library(ggplot2)
labordata
labordata %<>% filter (YEAR=="7")
model1<-WKS~LWAGE
ggplot(mpg, aes(WKS, LWAGE))
install.packages("tidyverse")
model1<-WKS~LWAGE
ggplot(mpg, aes(WKS, LWAGE))+
geom_point()
model1<-WKS~LWAGE
ggplot (data =labordata ) +
(mapping = aes(WKS,LWAGE)
model1<-WKS~LWAGE
ggplot( (data =labordata ) +
(mapping = aes(WKS,LWAGE)))
model1<-WKS~LWAGE
ggplot(data =labordata,
aes(WKS,LWAGE))
model1<-WKS~LWAGE
ggplot(data =labordata,
aes(WKS,LWAGE)) +
geom_point()
View(labordata)
View(labordata)
labordata %>%
group_by(union) %>%
summarise(avg = mean(lwage,wks))
labordata %>%
group_by(UNION) %>%
summarise(avg = mean(LWAGE,WKS))
labordata %>%
group_by(UNION) %>%
summarise(avg = mean(LWAGE,WKS))
labordata %>%
group_by(UNION)
wage1%>%
filter(educ>=12&educ<=16)%>%
group_by(cut(educ,breaks=c(12,12.5,15,16),include.lowest = T))%>%
summarise(mean(wage),N = n())
#建立方程式
is_numeric<-function(x) all(is.numeric(x))
cor_educ<-function(x) cor(x,wage1$educ)
cor_wage<-function(x) cor(x,wage1$wage)
#計算數值變數與educ的相關係數
wage1 %>%
select_if(is_numeric) %>%
summarise_all(cor_educ)
rm(list=ls())
library(dplyr)
library(psych)
library(haven)
wage1 <- read_dta("http://fmwww.bc.edu/ec-p/data/wooldridge/wage1.dta")
rm(list=ls())
library(dplyr)
library(psych)
library(haven)
wage1 <- read_dta("http://fmwww.bc.edu/ec-p/data/wooldridge/wage1.dta")
#沒有取對數
wage1 %>%
select(wage,educ) %>%
pairs.panels()
#對wage取對數
wage1 %>%
select(lwage,educ) %>%
pairs.panels()
wage1 %>%
lm(lwage~educ,data=.)
#建立方程式
is_numeric<-function(x) all(is.numeric(x))
cor_educ<-function(x) cor(x,wage1$educ)
cor_wage<-function(x) cor(x,wage1$wage)
#計算數值變數與educ的相關係數
wage1 %>%
select_if(is_numeric) %>%
summarise_all(cor_educ)
#計算數值變數與wage的相關係數
wage1 %>%
select_if(is_numeric) %>%
summarise_all(cor_wage)
wage1 %>%
lm(lwage~educ+smsa+profocc,data=.)
wage1%>%
filter(educ>=12&educ<=16)%>%
group_by(cut(educ,breaks=c(12,12.5,15,16),include.lowest = T))%>%
summarise(mean(wage),N = n())
labordata %>%
group_by(UNION)
labordata %<>% filter (YEAR=="7")
library(readr)
labordata <- read_csv("http://people.stern.nyu.edu/wgreene/Econometrics/cornwell&rupert.csv")
library(dplyr)
library(magrittr)
library(ggplot2)
labordata
labordata %<>% filter (YEAR=="7")
labordata %>%
group_by(UNION)
labordata %>%
group_by(UNION) %>%
summarise(avg = mean(LWAGE,WKS))
labordata %>%
group_by(UNION) %>%
avg = mean(LWAGE,WKS)
labordata %>%
group_by(UNION) %>%
summarise(avg = mean(LWAGE,WKS))
labordata %>%
group_by(cut(UNION,breaks=c(0,1),include.lowest = T))%>%
summarise(avg = mean(LWAGE,WKS))
labordata %>%
group_by(cut(UNION,breaks=c(0,1),include.lowest = T))%>%
summarise(avg = mean((LWAGE),(WKS)))
labordata %>%
group_by(UNION)
summarise(mean(LWAGE),MEAN(WKS))
model1<-WKS~LWAGE
ggplot(data =labordata,
aes(WKS,LWAGE)) +
geom_point()
labordata %<>% filter (YEAR=="7")
labordata %>%
group_by(UNION)
summarise(mean(LWAGE),MEAN(WKS))
labordata %>%
group_by(UNION)
summarise(MEAN(LWAGE),MEAN(WKS))
labordata %>%
group_by(UNION)
summarise(mean(LWAGE),mean(WKS))
labordata %>%
group_by(UNION)
summarise(mean(LWAGE),mean(WKS))
labordata
labordata %<>% filter (YEAR=="7")
model1<-WKS~LWAGE
ggplot(data =labordata,
aes(WKS,LWAGE)) +
geom_point()
labordata %>%
group_by(UNION)
summarise(mean(LWAGE),mean(WKS))
library(readr)
labordata <- read_csv("http://people.stern.nyu.edu/wgreene/Econometrics/cornwell&rupert.csv")
library(dplyr)
library(magrittr)
library(ggplot2)
library(readr)
labordata <- read_csv("http://people.stern.nyu.edu/wgreene/Econometrics/cornwell&rupert.csv")
library(dplyr)
library(magrittr)
library(ggplot2)
library(AER)
labordata
labordata %<>% filter (YEAR=="7")
model1<-WKS~LWAGE
ggplot(data =labordata,
aes(WKS,LWAGE)) +
geom_point()
labordata %>%
group_by(UNION)
summarise(mean(LWAGE),mean(WKS))
labordata %>%
group_by(UNION)
summarise(mean(LWAGE),mean(WKS))
library(readr)
labordata <- read_csv("http://people.stern.nyu.edu/wgreene/Econometrics/cornwell&rupert.csv")
